<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Bwallet</title>
    <base href="/">

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="http://cdn.peerjs.com/0.3/peer.js"></script>
    <script>
        window.moz = !!navigator.mozGetUserMedia;
        var chromeVersion = (function () {
            try{
                !!navigator.mozGetUserMedia ? 0 : parseInt(navigator.userAgent.match( /Chrom(e|ium)\/([0-9]+)\./ )[2]);
            }
            catch(ex){
                return false;
            }
        } )();


        function getIceServers() {
            var w = window,
                    PeerConnection = w.mozRTCPeerConnection || w.webkitRTCPeerConnection,
                    SessionDescription = w.mozRTCSessionDescription || w.RTCSessionDescription,
                    IceCandidate = w.mozRTCIceCandidate || w.RTCIceCandidate;

            var iceServers = [];

            if (moz) {
                iceServers.push({
                    url: 'stun:23.21.150.121'
                });

                iceServers.push({
                    url: 'stun:stun.services.mozilla.com'
                });
            }

            if (!moz) {
                iceServers.push({
                    url: 'stun:stun.l.google.com:19302'
                });

                iceServers.push({
                    url: 'stun:stun.anyfirewall.com:3478'
                });
            }

            if (!moz && chromeVersion < 28) {
                iceServers.push({
                    url: 'turn:homeo@turn.bistri.com:80',
                    credential: 'homeo'
                });
            }

            if (!moz && chromeVersion >= 28) {
                iceServers.push({
                    url: 'turn:turn.bistri.com:80',
                    credential: 'homeo',
                    username: 'homeo'
                });

                iceServers.push({
                    url: 'turn:turn.anyfirewall.com:443?transport=tcp',
                    credential: 'webrtc',
                    username: 'webrtc'
                });
            }


            return iceServers;
        }

        window.peer = new Peer({
            host: 'localhost', port: 9000, path: '/bwallet' ,
             debug: 3,
            config : {'iceServers': [
                { url: 'stun:stun.l.google.com:19302' },
                {
                    url: 'turn:numb.viagenie.ca',
                    credential: 'muazkh',
                    username: 'webrtc@live.com'
                }
            ]}
        });
    </script>
</head>
<body>
<app-root>Loading...</app-root>
</body>
</html>
